%PSD per brain lobe

load('RESULTS')

%median olwn twn subjects, ara katalhgw se freqband (5) * elecs (32) *
%condition (6) array 
median_powers(1,:,:) = median(RESULTS.EEG.frequency.delta, 3, 'omitnan');
median_powers(2,:,:) = median(RESULTS.EEG.frequency.theta, 3, 'omitnan');
median_powers(3,:,:) = median(RESULTS.EEG.frequency.alpha, 3, 'omitnan');
median_powers(4,:,:) = median(RESULTS.EEG.frequency.beta, 3, 'omitnan');
median_powers(5,:,:) = median(RESULTS.EEG.frequency.low_gamma, 3, 'omitnan');

%BAND POWER

%%
%%% FRONTAL LOBE : ELECTRODES fp1,fp2,f7,f3,fz,f4,f8 = 1,2,3,4,30,31,32 =
%%% 1:4;30:32

frontal_lobe = median_powers(:,[1:4,30:32],:);
frontal_lobe_powers(:,:) = median(frontal_lobe,2,'omitnan'); %kanw median ta elecs
sum_frontal_lobe_powers(:) = sum(frontal_lobe_powers,1); %athrizw ola ta bands gia to kathe condition

percentage_of_bands = (frontal_lobe_powers ./ sum_frontal_lobe_powers);

mp = max(percentage_of_bands,[], 'all');

figure('Name','Frontal Percentage')
spider_plot(percentage_of_bands', ...
    'AxesLabels', {'Delta', 'Theta', 'Alpha', 'Beta', {'Low';'Gamma'}}, ...
    'FillOption', 'on', ...
    'AxesWebType', 'circular', ...
    'FillTransparency', 0.05, ...
    'AxesDisplay', 'data-percent', ...
    'AxesDataOffset', 0, ...
    'MarkerSize', 24, ...
    'AxesFontSize', 12, ...
    'LabelFontSize', 12, ...
    'AxesRadialLineWidth', 0.5, ...
    'AxesWebLineWidth', 0.5, ...
    'LineWidth', 1.5, ...
    'AxesDataOffset', 0.05)
legend('ME', 'MI', 'MIMO', 'MIMOHP', 'MIMOVR', 'MIMOVRHP', ...
    'FontSize', 12)
%title('FRONTAL Percentage')

%PERCENTAGE DIFFERENCE

for i = 1:6
    percentage_difference(:,i) = percentage_of_bands(:,i) - percentage_of_bands(:,1);
end

figure('Name','Frontal Percentage Change')
spider_plot(percentage_difference(:,:)', ...
    'AxesLabels', {'Delta', 'Theta', 'Alpha', 'Beta', {'Low';'Gamma'}}, ...
    'AxesWebType', 'circular', ...
    'AxesDisplay', 'none', ...
    'FillOption', {'off','on','on','on','on','on'}, ...
    'FillTransparency', 0.05, ...
    'AxesDisplay', 'data-percent', ...
    'AxesDataOffset', 0, ...
    'MarkerSize', 24, ...
    'AxesFontSize', 12, ...
    'LabelFontSize', 12,...
    'AxesRadialLineWidth', 0.5, ...
    'AxesWebLineWidth', 0.5, ...
    'Color', [0,0,0; 0.85,0.325,0.098; 0.929,0.694,0.125; ...
    0.494,0.184,0.556; 0.466,0.674,0.188; 0.301,0.745,0.933 ], ...
    'LineStyle', {'--','-','-','-','-','-'}, ...
    'LineWidth', [1;1.5;1.5;1.5;1.5;1.5], ...
    'AxesDataOffset', 0.05)
legend('','MI', 'MIMO', 'MIMOHP', 'MIMOVR', 'MIMOVRHP', ...
    'FontSize', 12)
%title('FRONTAL Percentage Change')

%%
%%% CENTRAL LOBE : ELECTRODES 6,7,8,11,12,22,23,24,25,28,29 =
%%% 6:8,11:12,22:25,28:29

clear percentage_of_bands;
clear percentage_difference;    

central_lobe = median_powers(:,[6:8,11:12,22:25,28:29],:);
central_lobe_powers(:,:) = median(central_lobe,2,'omitnan'); %kanw median ta elecs
sum_central_lobe_powers(:) = sum(central_lobe_powers,1); %athrizw ola ta bands gia to kathe condition

percentage_of_bands = (central_lobe_powers ./ sum_central_lobe_powers);

mp = max(percentage_of_bands,[], 'all');

figure('Name','Central Percentage')
spider_plot(percentage_of_bands', ...
    'AxesLabels', {'Delta', 'Theta', 'Alpha', 'Beta', {'Low';'Gamma'}}, ...
    'FillOption', 'on', ...
    'AxesWebType', 'circular', ...
    'FillTransparency', 0.05, ...
    'AxesDisplay', 'data-percent', ...
    'AxesDataOffset', 0, ...
    'MarkerSize', 24, ...
    'AxesFontSize', 12, ...
    'LabelFontSize', 12, ...
    'AxesRadialLineWidth', 0.5, ...
    'AxesWebLineWidth', 0.5, ...
    'LineWidth', 1.5, ...
    'AxesDataOffset', 0.05)
legend('ME', 'MI', 'MIMO', 'MIMOHP', 'MIMOVR', 'MIMOVRHP', ...
    'FontSize', 12)
%title('CENTRAL Percentage')

%PERCENTAGE DIFFERENCE

for i = 1:6
    percentage_difference(:,i) = percentage_of_bands(:,i) - percentage_of_bands(:,1);
end

figure('Name','Central Percentage Change')
spider_plot(percentage_difference(:,:)', ...
    'AxesLabels', {'Delta', 'Theta', 'Alpha', 'Beta', {'Low';'Gamma'}}, ...
    'AxesWebType', 'circular', ...
    'AxesDisplay', 'none', ...
    'FillOption', {'off','on','on','on','on','on'}, ...
    'FillTransparency', 0.05, ...
    'AxesDisplay', 'data-percent', ...
    'AxesDataOffset', 0, ...
    'MarkerSize', 24, ...
    'AxesFontSize', 12, ...
    'LabelFontSize', 12,...
    'AxesRadialLineWidth', 0.5, ...
    'AxesWebLineWidth', 0.5, ...
    'Color', [0,0,0; 0.85,0.325,0.098; 0.929,0.694,0.125; ...
    0.494,0.184,0.556; 0.466,0.674,0.188; 0.301,0.745,0.933 ], ...
    'LineStyle', {'--','-','-','-','-','-'}, ...
    'LineWidth', [1;1.5;1.5;1.5;1.5;1.5], ...
    'AxesDataOffset', 0.05)
legend('','MI', 'MIMO', 'MIMOHP', 'MIMOVR', 'MIMOVRHP', ...
    'FontSize', 12)
%title('CENTRAL Percentage Change')


%%
%%% PARIETAL LOBE : ELECTRODES 13,14,15,19,20=
%%% 13:15,19:20

clear percentage_of_bands;
clear percentage_difference;    

parietal_lobe = median_powers(:,[13:15,19:20],:);
parietal_lobe_powers(:,:) = median(parietal_lobe,2,'omitnan'); %kanw median ta elecs
sum_parietal_lobe_powers(:) = sum(parietal_lobe_powers,1); %athrizw ola ta bands gia to kathe condition

percentage_of_bands = (parietal_lobe_powers ./ sum_parietal_lobe_powers);

mp = max(percentage_of_bands,[], 'all');

figure('Name','Parietal Percentage')
spider_plot(percentage_of_bands', ...
    'AxesLabels', {'Delta', 'Theta', 'Alpha', 'Beta', {'Low';'Gamma'}}, ...
    'FillOption', 'on', ...
    'AxesWebType', 'circular', ...
    'FillTransparency', 0.05, ...
    'AxesDisplay', 'data-percent', ...
    'AxesDataOffset', 0, ...
    'MarkerSize', 24, ...
    'AxesFontSize', 12, ...
    'LabelFontSize', 12, ...
    'AxesRadialLineWidth', 0.5, ...
    'AxesWebLineWidth', 0.5, ...
    'LineWidth', 1.5, ...
    'AxesDataOffset', 0.05)
legend('ME', 'MI', 'MIMO', 'MIMOHP', 'MIMOVR', 'MIMOVRHP', ...
    'FontSize', 12)
%title('PARIETAL Percentage')

%PERCENTAGE DIFFERENCE

for i = 1:6
    percentage_difference(:,i) = percentage_of_bands(:,i) - percentage_of_bands(:,1);
end

figure('Name','Parietal Percentage Change')
spider_plot(percentage_difference(:,:)', ...
    'AxesLabels', {'Delta', 'Theta', 'Alpha', 'Beta', {'Low';'Gamma'}}, ...
    'AxesWebType', 'circular', ...
    'AxesDisplay', 'none', ...
    'FillOption', {'off','on','on','on','on','on'}, ...
    'FillTransparency', 0.05, ...
    'AxesDisplay', 'data-percent', ...
    'AxesDataOffset', 0, ...
    'MarkerSize', 24, ...
    'AxesFontSize', 12, ...
    'LabelFontSize', 12,...
    'AxesRadialLineWidth', 0.5, ...
    'AxesWebLineWidth', 0.5, ...
    'Color', [0,0,0; 0.85,0.325,0.098; 0.929,0.694,0.125; ...
    0.494,0.184,0.556; 0.466,0.674,0.188; 0.301,0.745,0.933 ], ...
    'LineStyle', {'--','-','-','-','-','-'}, ...
    'LineWidth', [1;1.5;1.5;1.5;1.5;1.5], ...
    'AxesDataOffset', 0.05)
legend('','MI', 'MIMO', 'MIMOHP', 'MIMOVR', 'MIMOVRHP', ...
    'FontSize', 12)
%title('PARIETAL Percentage Change')

%%
%%% OCCIPITAL LOBE : ELECTRODES 16,17,18 =
%%% 16:18

clear percentage_of_bands;
clear percentage_difference;    

occipital_lobe = median_powers(:,[16:18],:);
occipital_lobe_powers(:,:) = median(occipital_lobe,2,'omitnan'); %kanw median ta elecs
sum_occipital_lobe_powers(:) = sum(occipital_lobe_powers,1); %athrizw ola ta bands gia to kathe condition

percentage_of_bands = (occipital_lobe_powers ./ sum_occipital_lobe_powers);

mp = max(percentage_of_bands,[], 'all');

figure('Name','Occipital Percentage')
spider_plot(percentage_of_bands', ...
    'AxesLabels', {'Delta', 'Theta', 'Alpha', 'Beta', {'Low';'Gamma'}}, ...
    'FillOption', 'on', ...
    'AxesWebType', 'circular', ...
    'FillTransparency', 0.05, ...
    'AxesDisplay', 'data-percent', ...
    'AxesDataOffset', 0, ...
    'MarkerSize', 24, ...
    'AxesFontSize', 12, ...
    'LabelFontSize', 12, ...
    'AxesRadialLineWidth', 0.5, ...
    'AxesWebLineWidth', 0.5, ...
    'LineWidth', 1.5, ...
    'AxesDataOffset', 0.05)
legend('ME', 'MI', 'MIMO', 'MIMOHP', 'MIMOVR', 'MIMOVRHP', ...
    'FontSize', 12)
%title('OCCIPITAL Percentage')

%PERCENTAGE DIFFERENCE

for i = 1:6
    percentage_difference(:,i) = percentage_of_bands(:,i) - percentage_of_bands(:,1);
end

figure('Name','Occipital Percentage Change')
spider_plot(percentage_difference(:,:)', ...
    'AxesLabels', {'Delta', 'Theta', 'Alpha', 'Beta', {'Low';'Gamma'}}, ...
    'AxesWebType', 'circular', ...
    'AxesDisplay', 'none', ...
    'FillOption', {'off','on','on','on','on','on'}, ...
    'FillTransparency', 0.05, ...
    'AxesDisplay', 'data-percent', ...
    'AxesDataOffset', 0, ...
    'MarkerSize', 24, ...
    'AxesFontSize', 12, ...
    'LabelFontSize', 12,...
    'AxesRadialLineWidth', 0.5, ...
    'AxesWebLineWidth', 0.5, ...
    'Color', [0,0,0; 0.85,0.325,0.098; 0.929,0.694,0.125; ...
    0.494,0.184,0.556; 0.466,0.674,0.188; 0.301,0.745,0.933 ], ...
    'LineStyle', {'--','-','-','-','-','-'}, ...
    'LineWidth', [1;1.5;1.5;1.5;1.5;1.5], ...
    'AxesDataOffset', 0.05)
legend('','MI', 'MIMO', 'MIMOHP', 'MIMOVR', 'MIMOVRHP', ...
    'FontSize', 12)
%title('OCCIPITAL Percentage Change')

%%
%%% TEMPORAL LOBE : ELECTRODES 5,9,10,21,26,27
%%% 5,9:10,21,26:27

clear percentage_of_bands;
clear percentage_difference;    

temporal_lobe = median_powers(:,[5,9:10,21,26:27],:);
temporal_lobe_powers(:,:) = median(temporal_lobe,2,'omitnan'); %kanw median ta elecs
sum_temporal_lobe_powers(:) = sum(temporal_lobe_powers,1); %athrizw ola ta bands gia to kathe condition

percentage_of_bands = (temporal_lobe_powers ./ sum_temporal_lobe_powers);

mp = max(percentage_of_bands,[], 'all');

figure('Name','Temporal Percentage')
spider_plot(percentage_of_bands', ...
    'AxesLabels', {'Delta', 'Theta', 'Alpha', 'Beta', {'Low';'Gamma'}}, ...
    'FillOption', 'on', ...
    'AxesWebType', 'circular', ...
    'FillTransparency', 0.05, ...
    'AxesDisplay', 'data-percent', ...
    'AxesDataOffset', 0, ...
    'MarkerSize', 24, ...
    'AxesFontSize', 12, ...
    'LabelFontSize', 12, ...
    'AxesRadialLineWidth', 0.5, ...
    'AxesWebLineWidth', 0.5, ...
    'LineWidth', 1.5, ...
    'AxesDataOffset', 0.05)
legend('ME', 'MI', 'MIMO', 'MIMOHP', 'MIMOVR', 'MIMOVRHP', ...
    'FontSize', 12)
%title('TEMPORAL Percentage')

%PERCENTAGE DIFFERENCE

for i = 1:6
    percentage_difference(:,i) = percentage_of_bands(:,i) - percentage_of_bands(:,1);
end

figure('Name','Temporal Percentage Change')
spider_plot(percentage_difference(:,:)', ...
    'AxesLabels', {'Delta', 'Theta', 'Alpha', 'Beta', {'Low';'Gamma'}}, ...
    'AxesWebType', 'circular', ...
    'AxesDisplay', 'none', ...
    'FillOption', {'off','on','on','on','on','on'}, ...
    'FillTransparency', 0.05, ...
    'AxesDisplay', 'data-percent', ...
    'AxesDataOffset', 0, ...
    'MarkerSize', 24, ...
    'AxesFontSize', 12, ...
    'LabelFontSize', 12,...
    'AxesRadialLineWidth', 0.5, ...
    'AxesWebLineWidth', 0.5, ...
    'Color', [0,0,0; 0.85,0.325,0.098; 0.929,0.694,0.125; ...
    0.494,0.184,0.556; 0.466,0.674,0.188; 0.301,0.745,0.933 ], ...
    'LineStyle', {'--','-','-','-','-','-'}, ...
    'LineWidth', [1;1.5;1.5;1.5;1.5;1.5], ...
    'AxesDataOffset', 0.05)
legend('','MI', 'MIMO', 'MIMOHP', 'MIMOVR', 'MIMOVRHP', ...
    'FontSize', 12)
%title('TEMPORAL Percentage Change')